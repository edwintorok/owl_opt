<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Make (owl-opt.Owl_opt__Adam_d.Make)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">owl-opt</a> &#x00BB; <a href="../index.html">Owl_opt__Adam_d</a> &#x00BB; Make</nav><h1>Module <code>Owl_opt__Adam_d.Make</code></h1></header><h3 class="heading">Parameters</h3><ul><li><code><a href="argument-1-P/index.html">P</a> : <a href="../../Owl_opt/Prms/index.html#module-type-PT">Owl_opt.Prms.PT</a></code></li></ul><h3 class="heading">Signature</h3><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> <span>'a t</span></code></dt><dd><p>user-defined record type</p></dd></dl><dl><dt class="spec type" id="type-fv"><a href="#type-fv" class="anchor"></a><code><span class="keyword">type</span> fv</code><code> = Owl.Algodiff.D.t</code></dt><dd><p>objective function value type</p></dd></dl><dl><dt class="spec type" id="type-prm"><a href="#type-prm" class="anchor"></a><code><span class="keyword">type</span> prm</code><code> = Owl.Algodiff.D.t</code></dt><dd><p>paramter type</p></dd></dl><dl><dt class="spec type" id="type-prms"><a href="#type-prms" class="anchor"></a><code><span class="keyword">type</span> prms</code><code> = <span><a href="index.html#type-prm">prm</a> <a href="index.html#type-t">t</a></span></code></dt><dd><p>user-defined paramter record type</p></dd></dl><dl><dt class="spec type" id="type-f"><a href="#type-f" class="anchor"></a><code><span class="keyword">type</span> f</code><code> = int <span>&#45;&gt;</span> <a href="index.html#type-prms">prms</a> <span>&#45;&gt;</span> <a href="index.html#type-fv">fv</a></code></dt><dd><p>objective function type</p></dd></dl><dl><dt class="spec type" id="type-state"><a href="#type-state" class="anchor"></a><code><span class="keyword">type</span> state</code></dt><dd><p>internal state</p></dd></dl><dl><dt class="spec type" id="type-status"><a href="#type-status" class="anchor"></a><code><span class="keyword">type</span> status</code><code> = <a href="../../Owl_opt__/Status/index.html#type-t">Owl_opt__.Status.t</a></code><code> = </code><table class="variant"><tr id="type-status.Continue" class="anchored"><td class="def constructor"><a href="#type-status.Continue" class="anchor"></a><code>| </code><code><span class="constructor">Continue</span> <span class="keyword">of</span> float</code></td></tr><tr id="type-status.Stop" class="anchored"><td class="def constructor"><a href="#type-status.Stop" class="anchor"></a><code>| </code><code><span class="constructor">Stop</span> <span class="keyword">of</span> float</code></td></tr></table></dt><dd><p>optimization status</p></dd></dl><dl><dt class="spec type" id="type-stop"><a href="#type-stop" class="anchor"></a><code><span class="keyword">type</span> stop</code><code> = float <span>&#45;&gt;</span> <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>stopping criterion function type</p></dd></dl><dl><dt class="spec value" id="val-iter"><a href="#val-iter" class="anchor"></a><code><span class="keyword">val</span> iter : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>iter s</code> returns the current iteration number of state <code>s</code></p></dd></dl><dl><dt class="spec value" id="val-prms"><a href="#val-prms" class="anchor"></a><code><span class="keyword">val</span> prms : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-prms">prms</a></code></dt><dd><p><code>prms s</code> returns the optimisation parameters of state <code>s</code></p></dd></dl><dl><dt class="spec value" id="val-prev_fv"><a href="#val-prev_fv" class="anchor"></a><code><span class="keyword">val</span> prev_fv : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> float</code></dt><dd><p><code>prev_fv s</code> returns the last objective function value of state <code>s</code></p></dd></dl><dl><dt class="spec value" id="val-fv_hist"><a href="#val-fv_hist" class="anchor"></a><code><span class="keyword">val</span> fv_hist : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <span>float list</span></code></dt><dd><p><code>fv_hist s</code> returns the history of the objective function values of state <code>s</code> up to the last objective function value (i.e., <code>prev_f s</code> is the same as <code>List.hd (fv_hist s)</code>)</p></dd></dl><dl><dt class="spec value" id="val-init"><a href="#val-init" class="anchor"></a><code><span class="keyword">val</span> init : <span>?&#8288;beta1:float</span> <span>&#45;&gt;</span> <span>?&#8288;beta2:float</span> <span>&#45;&gt;</span> <span>?&#8288;eps:float</span> <span>&#45;&gt;</span> <span>lr:<a href="../../Owl_opt/Lr/index.html#type-t">Owl_opt.Lr.t</a></span> <span>&#45;&gt;</span> <span>prms0:<a href="index.html#type-prms">prms</a></span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-state">state</a></code></dt><dd><p><code>init ?(beta1=0.99) ?(beta2=0.999) ?(eps=1E-8) ~lr ~prms0 ()</code> initialises and returns optimisation state <code>s</code> with initial parmaters <code>prms0</code>. The hyperparamters <code>beta1</code>, <code>beta2</code>, and <code>eps</code> are defined <a href="https://arxiv.org/pdf/1412.6980.pdf">here</a>.</p></dd></dl><dl><dt class="spec value" id="val-stop"><a href="#val-stop" class="anchor"></a><code><span class="keyword">val</span> stop : float <span>&#45;&gt;</span> <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>stop fv s</code> is the default stopping criterion, which prints out the iteration and objective function value at each optimisation iteration and terminates when the objective function value goes below 1E-4</p></dd></dl><dl><dt class="spec value" id="val-min_step"><a href="#val-min_step" class="anchor"></a><code><span class="keyword">val</span> min_step : <span>?&#8288;stop:<a href="index.html#type-stop">stop</a></span> <span>&#45;&gt;</span> <span>f:<a href="index.html#type-f">f</a></span> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-status">status</a></code></dt><dd><p><code>min_step ?(stop=stop) ~f s</code> computes the function value <code>fv</code> of optimization state <code>s</code> with parameters (i.e., <code>f (iter s) (prms s)</code> returns <code>fv</code>). If the stopping criterion is reached (i.e. <code>stop fv s</code> is <code>true</code>), then return <code>Stop fv</code> and no optimization is performed. Otherwise, minizie <code>f</code> by updating the parameters of <code>s</code> one step (in place) according to Adam and returns <code>Continue fv</code>. Here, <code>stop fv s</code> is a callback function that can be used to specify the termination criterion and print out intermediate function values.</p></dd></dl><dl><dt class="spec value" id="val-max_step"><a href="#val-max_step" class="anchor"></a><code><span class="keyword">val</span> max_step : <span>?&#8288;stop:<a href="index.html#type-stop">stop</a></span> <span>&#45;&gt;</span> <span>f:<a href="index.html#type-f">f</a></span> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-status">status</a></code></dt><dd><p><code>max_step ?(stop=stop) ~f ~lr</code> is similar to <code>min_step</code> but maximises f.</p></dd></dl><dl><dt class="spec value" id="val-min"><a href="#val-min" class="anchor"></a><code><span class="keyword">val</span> min : <span>?&#8288;stop:<a href="index.html#type-stop">stop</a></span> <span>&#45;&gt;</span> <span>f:<a href="index.html#type-f">f</a></span> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> float</code></dt><dd><p><code>min ?(stop=stop) ~f status</code> iteratively minimises <code>f</code> using Adam until the stopping criterion is reached (i.e., <code>stop fv s</code> returns <code>true</code>), then returns the final function value <code>fv</code>. See <code>min_step</code> for details on <code>stop</code>.</p></dd></dl><dl><dt class="spec value" id="val-max"><a href="#val-max" class="anchor"></a><code><span class="keyword">val</span> max : <span>?&#8288;stop:<a href="index.html#type-stop">stop</a></span> <span>&#45;&gt;</span> <span>f:<a href="index.html#type-f">f</a></span> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> float</code></dt><dd><p><code>max ?(stop=stop) ~f ~lr s</code> is similar to <code>min</code> but maximises f.</p></dd></dl></div></body></html>