<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Owl_opt (owl-opt.Owl_opt)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">owl-opt</a> &#x00BB; Owl_opt</nav><h1>Module <code>Owl_opt</code></h1><h2 id="workflow"><a href="#workflow" class="anchor"></a>Workflow</h2><nav class="toc"><ul><li><a href="#example">Example</a></li><li><a href="#single-precision-module">Single-precision module</a></li><li><a href="#double-precision-module">Double-precision module</a></li><li><a href="#prm-module-type">Prm module type</a></li><li><a href="#learning-rate-module">Learning rate module</a></li></ul></nav></header><aside><ol><li>define your optimisation parameter record and apply <code>@@deriving prms</code></li><li>make an optimisation module <code>O</code> using your favourite algorithm functor</li><li>define an objective function that takes as input your parameter type</li><li>define initial parameters</li><li>define learning rates with <a href="Lr/index.html"><code>Lr</code></a></li><li>initialise optimisation session <code>s</code> with <code>O.init</code></li><li>define stoping criterion function <code>stop: state -&gt; bool</code></li><li>minimise the optimisation session</li></ol></aside><section><header><h2 id="example"><a href="#example" class="anchor"></a>Example</h2></header><aside><pre><code class="ml">module Prms = struct
   type 'a t = {a: 'a; b: 'a} [@@deriving prms]
end
(* make an Adam optimisation module for the parameter definition Prms *)
module O = Owl_opt.D.Adam.Make (Prms)

(* define the objective function *)
let f prms = Owl.Algodiff.D.Maths.(l2norm' (y - ((prms.a *@ x) + prms.b))) 

(* define initial parameters *)
let prms0 = {a = Owl.Algodiff.D.Mat.gaussian 5 5; b = Owl.Algodiff.D.gaussian 5 1} 

(* define fixed learning rate *)
let lr = Owl_opt.Lr.(Fix 1E-4) 

(* initialise an optimisation session *)
let s0 = O.init ~prms0 ~f () 

(* define stopping criteria: stop when function value is smaller than 1E-4 *)
let stop s = O.(fv s) &lt; 1E-4

(* minimise objective function f *)
let s = O.min ~stop ~beta1:0.99 ~beta2:0.999 ~lr f

(* final objective function value *)
let c = O.fv s

(* final prms *)
let prms = O.prms s </code></pre></aside></section><section><header><h2 id="single-precision-module"><a href="#single-precision-module" class="anchor"></a>Single-precision module</h2></header><div class="spec module" id="module-S"><a href="#module-S" class="anchor"></a><code><span class="keyword">module</span> <a href="S/index.html">S</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></section><section><header><h2 id="double-precision-module"><a href="#double-precision-module" class="anchor"></a>Double-precision module</h2></header><div class="spec module" id="module-D"><a href="#module-D" class="anchor"></a><code><span class="keyword">module</span> <a href="D/index.html">D</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></section><section><header><h2 id="prm-module-type"><a href="#prm-module-type" class="anchor"></a>Prm module type</h2></header><dl><dt class="spec module" id="module-Prms"><a href="#module-Prms" class="anchor"></a><code><span class="keyword">module</span> <a href="Prms/index.html">Prms</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>input module type to functors that make optimisation modules such as <a href="../Owl_opt__/Adam_d/Make/index.html"><code>Owl_opt.D.Adam.Make</code></a></p></dd></dl></section><section><header><h2 id="learning-rate-module"><a href="#learning-rate-module" class="anchor"></a>Learning rate module</h2></header><dl><dt class="spec module" id="module-Lr"><a href="#module-Lr" class="anchor"></a><code><span class="keyword">module</span> <a href="Lr/index.html">Lr</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>learning rate module</p></dd></dl></section></div></body></html>